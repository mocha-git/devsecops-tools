#!/usr/bin/env python3
"""
Simple script to test a WAF by sending various potentially malicious payloads.
Be-aware please, use this responsibly in a controlled environment.
"""

import requests

# Replace with your API Gateway or WAF-protected endpoint
TARGET_URL = "https://<your_api_id>.execute-api.<region>.amazonaws.com/prod/hello"

# Common attack payloads to probe SQLi, XSS, etc.
TEST_PAYLOADS = [
    "' OR '1'='1",
    "<script>alert('XSS')</script>",
    "../../etc/passwd",
    "' UNION SELECT * FROM users --",
    "<img src=x onerror=alert('XSS')>",
    "'; DROP TABLE users; --"
]

def test_waf():
    for payload in TEST_PAYLOADS:
        params = {"name": payload}
        try:
            response = requests.get(TARGET_URL, params=params, timeout=5)
            print(f"Sent payload: {payload}")
            print(f"Status Code: {response.status_code}")
            print(f"Response Body: {response.text[:200]}...\n")
        except requests.RequestException as e:
            print(f"Error with payload '{payload}': {e}")

if __name__ == "__main__":
    test_waf()

